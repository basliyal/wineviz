<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <title></title>
  <link rel="stylesheet" type="text/css" href="mystyle.css">
</head>
<body>

  <div> <br> <br> <br> Below  World map shows the Win stats around the world. <br> <br> <br></div>
  <div id="winemap"></div>

</br>
<a href="countrycheck.html" class="backbutton">Go Back</a>
<a href="index.html" class="button">Learn More</a>

</body>
<!-- Load d3.js and the geo projection plugin -->
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/topojson.v0.min.js"></script>

<script src="worldmap.js"></script>
<script>

var val = JSON.parse(window.localStorage.getItem('value'));
var aggdata = d3.nest()
.key(function(d) { return d[2]; })
.rollup(function(v) { return v.length })
.entries(val)
.sort(function(a,b) {return d3.descending(a.value,b.value);})

var qualityavg = d3.nest()
.key(function(d) { return d[2]; })
.rollup(function(v) {
  var count = v.length;
  var total = d3.sum(v, function(d) { return d[0] })
  return total/count;
})
.entries(val)
.sort(function(a,b) {return d3.descending(a.value,b.value);})

var priceavg = d3.nest()
.key(function(d) { return d[2]; })
.rollup(function(v) {
  var count = v.length;
  var total = d3.sum(v, function(d) { return d[1] })
  return total/count;
})
.entries(val)
.sort(function(a,b) {return d3.descending(a.value,b.value);})


drawChart(aggdata, "Total Rating Counts by Country");
</script>
</html>
